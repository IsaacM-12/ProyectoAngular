<div class="StrategicPlanStyle">
  <h1>Strategic Plan</h1>
  <div *ngIf="!isFormVisible && !isEditMode">
    <button (click)="createNewPlan()" class="buttonAdd">Plan</button>

    <div *ngIf="strategicPlanData.length > 0; else noData">
      <div *ngFor="let item of strategicPlanData">
        <button (click)="editPlan(item)" class="link-button m-3">
          <strong>Name:</strong> {{ item.name }}, <strong>startDate</strong>
          {{ item.startDate }}
        </button>
        <button (click)="deletePlan(item.id)" class="btn btn-danger m-2">
          Delete Plan
        </button>
      </div>
    </div>
    <ng-template #noData>
      <p>No data available.</p>
    </ng-template>
  </div>

  <!-- si no es visible el formulario y no es modo edicion se muestra el boton de crear nuevo plan 
   y el form solo si es nuevo o se da click en editar -->
  <div *ngIf="isEditMode || isFormVisible">
    <button (click)="resetForm()" class="buttonBack">Back to plans</button>

    <div *ngIf="isEditMode" class="m-4">
      <h2>Plan</h2>
      <div *ngFor="let item of strategicPlanData">
        <div *ngIf="item.id === currentPlanId" class="StrategicContainer">
          <div>
            <button (click)="setFormVisibility(true)" class="buttonEdit m-2">
              Edit
            </button>
            <button (click)="navigateToFodaMeca()" class="buttonAdd m-2">
              Foda Meca
            </button>
          </div>
          <div class="rowStrategicPlan">
            <div class="title">
              <span>Name</span>
            </div>
            <div class="value">
              {{ item.name }}
            </div>
          </div>
          <div class="rowStrategicPlan">
            <div class="value">
              {{ item.startDate }}
            </div>
            <div class="title">
              <span>Start Date</span>
            </div>
          </div>

          <div class="rowStrategicPlan">
            <div class="title">
              <span>End Date</span>
            </div>
            <div class="value">
              {{ item.endDate }}
            </div>
          </div>
          <div class="rowStrategicPlan">
            <div class="value">
              {{ item.mission }}
            </div>
            <div class="title">
              <span>Mission</span>
            </div>
          </div>
          <div class="rowStrategicPlan">
            <div class="title">
              <span>Vision</span>
            </div>
            <div class="value">
              {{ item.vision }}
            </div>
          </div>
          <div class="rowStrategicPlan">
            <div class="value">
              {{ item.values }}
            </div>
            <div class="title">
              <span>Values</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="isFormVisible" class="form1-card">
      <form [formGroup]="formStrategicPlan" (submit)="sendData()" class="form1">
        <div>
          <h2>Strategic Plan Form</h2>
          <div>
            <input
              placeholder="Name"
              type="text"
              id="name"
              formControlName="name"
            />
            <div
              *ngIf="
                formStrategicPlan.get('name')?.invalid &&
                (formStrategicPlan.get('name')?.dirty ||
                  formStrategicPlan.get('name')?.touched)
              "
              class="error"
            >
              <p *ngIf="formStrategicPlan.get('name')?.errors?.['required']">
                Name is required.
              </p>
            </div>
          </div>

          <div>
            <textarea
              placeholder="mission"
              type="text"
              id="mission"
              formControlName="mission"
            ></textarea>
          </div>

          <div>
            <textarea
              placeholder="vision"
              type="text"
              id="vision"
              formControlName="vision"
            ></textarea>
          </div>

          <div>
            <textarea
              placeholder="values"
              type="text"
              id="values"
              formControlName="values"
            ></textarea>
          </div>

          <div>
            <div>
              <label for="endDate"> End Date: </label>
            </div>
            <input
              placeholder="endDate"
              type="date"
              [min]="minEndDate"
              id="endDate"
              formControlName="endDate"
            />
            <div
              *ngIf="
                formStrategicPlan.get('endDate')?.invalid &&
                (formStrategicPlan.get('endDate')?.dirty ||
                  formStrategicPlan.get('endDate')?.touched)
              "
              class="error"
            >
              <p *ngIf="formStrategicPlan.get('endDate')?.errors?.['required']">
                endDate is required.
              </p>
            </div>
          </div>

          <!-- Show the error div if the form is invalid -->
          <div class="badInfo" *ngIf="!formStrategicPlan.valid">
            <p>Not ready to send</p>
          </div>
          <button type="submit" class="buttonCreate m-3">Submit</button>
        </div>
      </form>
    </div>
  </div>

  <div class="container-card-perzonnalized1">
    <div class="card-perzonnalized1 m-4">
      <div class="shadowTopRight"></div>
      <div class="shadowButtomLeft"></div>
    </div>
  </div>
</div>
